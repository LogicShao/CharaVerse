## 📋 CharaVerse：OC管理系统与名片展示前端项目大纲

### **一、项目整体架构概览**

#### 1.1 项目结构
```
oc-profile-system/
├── src/
│   ├── types/              # TypeScript类型定义
│   ├── models/             # 数据模型和JSON Schema
│   ├── components/         # React组件
│   ├── pages/              # 页面组件
│   ├── services/           # 数据服务层
│   ├── hooks/              # 自定义React Hooks
│   ├── utils/              # 工具函数
│   ├── styles/             # 全局样式
│   └── App.tsx             # 主应用组件
├── public/                 # 静态资源
├── data/                   # OC数据存储目录
│   └── characters/         # 单个OC的JSON文件
└── package.json
```

#### 1.2 技术栈
- **前端框架**: React 18+ with TypeScript
- **状态管理**: Zustand或Context API
- **样式方案**: CSS Modules或Tailwind CSS
- **组件库**: 可选（headless UI或自定义组件）
- **数据存储**: 本地JSON文件或LocalStorage
- **构建工具**: Vite或Create React App

***

### **二、OC JSON数据模板结构设计**

#### 2.1 核心JSON Schema设计理念

**设计原则**：
- **完整性**: 涵盖角色的所有关键信息维度
- **可扩展性**: 支持自定义字段和插件式扩展
- **版本控制**: 包含Schema版本以适应未来升级
- **验证友好**: 便于TypeScript和运行时验证

#### 2.2 JSON模板的主要部分

##### **Part A: 基础信息块（Basic Profile）**
- 唯一标识符（UUID）
- 英文名和中文名
- 昵称和别称
- 创建日期和最后修改日期
- 创作者信息
- Schema版本号

##### **Part B: 外观设计块（Appearance）**
- **身体信息**
    - 年龄和生理年龄
    - 身高和体重
    - 体型描述（纤细、健壮、圆润等）
    - 肤色和肤质

- **面部特征**
    - 脸型（方形、圆形、菱形等）
    - 眼睛（形状、颜色、特殊标记）
    - 眉毛（形状、颜色、浓度）
    - 鼻子（形状、大小）
    - 嘴唇（颜色、厚度、形状）
    - 脸部标记（疤痕、纹身、胎记、雀斑）

- **发型信息**
    - 发色（主色和副色）
    - 发长（超短、短、齐肩、长发、超长）
    - 发型名称和描述
    - 发质（直、卷、烫染程度）

- **其他外观**
    - 体毛特征
    - 装饰品（耳环、项链、手环、眼镜等）
    - 疤痕位置和故事
    - 纹身位置和含义

##### **Part C: 服装与配饰块（Wardrobe）**
- 默认服装
- 多套服装变化
    - 服装名称
    - 完整描述
    - 颜色搭配
    - 风格分类（日常、正装、休闲、战斗等）
    - 关联故事或场景
- 主要配饰列表
- 标志性武器或工具

##### **Part D: 性格与心理块（Personality & Psychology）**
- **性格类型**
    - MBTI类型
    - 星座
    - 血型（如果适用）

- **性格特征**
    - 核心性格描述
    - 5-7个主要性格特质（积极和消极）
    - 性格动机

- **心理状态**
    - 主要恐惧
    - 核心欲望
    - 创伤或心理阴影
    - 心理防御机制

- **表现方式**
    - 说话习惯和口头禅
    - 行动风格
    - 情感表达方式
    - 肢体语言特征

##### **Part E: 背景故事块（Background Story）**
- 出生地和社会背景
- 家庭成员和关系
- 童年经历
- 重要的人生转折点
- 教育背景
- 主要经历和冒险
- 当前生活状态

##### **Part F: 能力与专长块（Skills & Abilities）**
- 职业或身份
- 主要技能列表（附带等级或熟练度）
- 特殊能力（如魔法、超能力等）
- 弱点和限制
- 战斗风格（如果适用）
- 工具掌握度

##### **Part G: 关系网络块（Relationships）**
- 与其他OC或既有角色的关系
    - 关系对象名称
    - 关系类型（朋友、敌人、导师、浪漫对象等）
    - 关系强度
    - 关系描述
    - 重要事件或共同回忆

##### **Part H: 设定与世界块（Lore & World）**
- 角色所属的宇宙或世界观
- 种族或物种信息
- 社会阶级或身份地位
- 文化或派系从属
- 宗教或信仰
- 价值观和生活哲学

##### **Part I: 补充信息块（Additional Info）**
- 爱好和兴趣
- 讨厌的东西
- 特殊习惯
- 梦想和目标
- 座右铭或个性签名
- 标签（用于分类和检索）

##### **Part J: 媒体资源块（Media Assets）**
- 头像图片URL/本地路径
- 全身图片URL/本地路径
- 其他参考图片列表
- 多个角度的视图链接
- 官方配图或粉丝艺术

##### **Part K: 元数据块（Metadata）**
- 创建者信息
- 版本历史
- 许可证信息（是否允许他人创作同人）
- 相关链接（AO3、微博、推特等）
- 自定义标签

***

### **三、TypeScript类型系统设计**

#### 3.1 核心类型定义的分层结构

**第一层：原始类型和枚举**
- 定义所有可能的枚举值（比如肤色选项、发色分类、性格特质类别等）
- 定义可复用的基础类型（比如ID类型、时间戳类型、URL类型）
- 定义联合类型用于严格的分类（比如关系类型：'friend' | 'enemy' | 'romantic'）

**第二层：单一职责接口**
- 为每个JSON块创建独立的TypeScript Interface
- 每个Interface对应一个清晰的数据职责
- 使用`partial<>`来表示可选字段
- 为复杂字段创建嵌套接口

**第三层：组合接口**
- 创建主接口（Character或OCProfile）
- 使用类型继承或交集（&）操作符组合各个部分接口
- 实现版本化设计以支持向后兼容

**第四层：工具类型和泛型**
- 创建通用的类型转换工具
- 定义API响应类型
- 创建表单验证类型

#### 3.2 关键接口示例结构（不写代码，只说明思路）

**BasicProfile接口**：包含id、名字、别名、创建时间等字段，所有字段都是必需的或有默认值

**AppearanceProfile接口**：包含所有身体、面部、头发等相关的嵌套对象，各个子对象都有自己的接口定义

**PersonalityProfile接口**：包含性格特质数组、心理状态对象、表现方式对象等

**RelationshipEntry接口**：表示单个关系，包含目标角色信息、关系类型、描述等字段

**CompleteOCProfile接口**：组合所有上述接口，形成完整的角色数据结构

#### 3.3 类型验证策略

- 使用Zod或Yup库进行运行时验证
- 创建type guards来检查对象是否符合特定接口
- 实现版本迁移函数用于升级旧版本的OC数据

***

### **四、前端名片展示组件设计**

#### 4.1 组件树结构

```
App
├── OCListPage（列表页面）
│   ├── SearchBar（搜索组件）
│   ├── FilterPanel（筛选面板）
│   └── OCGrid（网格布局）
│       └── OCCardPreview（卡片预览）*多个
│
├── OCDetailPage（详情页面）
│   ├── HeaderSection（顶部信息区）
│   ├── TabNavigation（标签导航）
│   └── ContentArea（内容区域）
│       ├── BasicInfoPanel（基础信息面板）
│       ├── AppearancePanel（外观信息面板）
│       ├── PersonalityPanel（性格信息面板）
│       ├── BackgroundPanel（背景故事面板）
│       ├── SkillsPanel（技能面板）
│       ├── RelationshipsPanel（关系面板）
│       └── GalleryPanel（媒体资源面板）
│
└── OCCardComponent（独立名片卡片）
    ├── CardHeader（卡片头部）
    ├── AvatarSection（头像区域）
    ├── BasicInfoSection（基础信息区）
    ├── AppearanceSummary（外观摘要）
    ├── PersonalitySummary（性格摘要）
    └── ActionButtons（操作按钮）
```

#### 4.2 主要组件详细设计

##### **OCCardPreview（卡片预览组件）**

**职责**：
- 显示OC的缩略视图
- 用于列表展示
- 可点击导航到详情页

**设计要点**：
- 使用纵向卡片设计（Vertical Card Layout）
- 顶部是OC头像，占卡片高度的40-50%
- 头像下方显示基础信息区
- 包含名字、昵称、简短的性格标签（3-5个）
- 底部显示创建时间和编辑按钮
- 应支持hover效果（阴影增强、轻微放大）
- 响应式设计：桌面版显示3-4列，平板2列，手机1列

**交互特性**：
- 点击卡片进入详情页
- 右上角快速操作菜单（编辑、删除、导出）
- 长按显示更多操作选项（仅移动端）

##### **OCCardComponent（完整名片卡片）**

**职责**：
- 作为独立的可复用名片组件
- 显示OC的完整或精简信息
- 支持多种展示模式

**设计要点**：

**模式1：详情模式（Detail Mode）**
- 横向分为两个区域：左侧头像，右侧信息
- 左侧：高清头像（可点击查看全身图）
- 右侧：分成多个信息块
    - 顶部：姓名、昵称、基础信息（年龄、身高等）
    - 中部：性格特质展示（可用Tag或Badge）
    - 下部：快速统计（如技能数、关系数等）

**模式2：精简模式（Compact Mode）**
- 纵向布局，适合作为sidebar或小窗口显示
- 头像 > 姓名 > 主要性格特质 > 关键能力
- 高度优化，信息密度高但不拥挤

**模式3：弹窗模式（Modal Mode）**
- 中心弹窗显示
- 头部：头像和基础信息
- 中部：可滚动的详细内容
- 底部：关闭和操作按钮

**设计元素**：
- 使用色彩编码（可根据属性/派系分配主题色）
- 性格特质用Pill-style Tag显示
- 信息优先级通过大小和颜色区分
- 支持Light和Dark主题

##### **AppearancePanel（外观信息面板）**

**职责**：
- 详细展示OC的外观信息
- 支持图片和文字结合

**设计要点**：
- 左侧：高清全身图或多个角度的图片轮播
- 右侧：外观信息分组展示
    - 分为：身体、面部、发型、特殊标记、服装等小分类
    - 每个分类可展开/折叠
    - 信息使用列表形式，标签+值的组合
    - 颜色信息显示实际色块
- 支持图片放大预览功能

##### **PersonalityPanel（性格信息面板）**

**职责**：
- 展示OC的性格特征和心理状态
- 可视化展示性格维度

**设计要点**：
- 顶部：MBTI、星座等快速标签
- 性格特质：使用词云、雷达图或列表展示
    - 如果使用可视化，要区分正面和负面特质
    - 可使用不同颜色区分
- 心理信息：恐惧、欲望、创伤等以卡片或列表显示
- 表现方式：用引用框或特殊样式突出口头禅

##### **RelationshipsPanel（关系面板）**

**职责**：
- 展示OC与其他角色的关系网络
- 支持关系的可视化和文字描述

**设计要点**：
- 左侧：关系网络图
    - 中心是当前OC
    - 周围是其他相关角色（圆圈或卡片）
    - 使用不同颜色或线条样式表示不同的关系类型
    - 点击节点可查看详情或切换到该OC

- 右侧：关系列表
    - 列出所有关系（可按类型筛选）
    - 每个关系显示：关系对象名称、关系类型、强度指标、简述
    - 支持展开查看完整关系描述

- 可交互的关系强度显示（进度条或星级）

##### **BackgroundPanel（背景故事面板）**

**职责**：
- 以故事形式展示OC的背景信息
- 支持时间轴展示

**设计要点**：
- 选项1：时间轴视图
    - 纵向时间轴
    - 关键事件作为节点
    - 每个节点可展开显示详情

- 选项2：分段故事视图
    - 按出生地→家庭→童年→转折→现在分段
    - 每段有标题和详细描述
    - 可配图

- 选项3：混合视图
    - 上部时间轴快速导航
    - 下部详细内容展示

##### **SkillsPanel（技能面板）**

**职责**：
- 展示OC的各种技能和能力
- 可视化技能水平

**设计要点**：
- 分类显示：职业技能、特殊能力、战斗风格等
- 每个技能显示：
    - 技能名称
    - 掌握等级（使用进度条、星级或百分比）
    - 简短描述
    - 相关的装备或学习来源

- 支持技能搜索和筛选
- 可选的技能树图形化展示

##### **GalleryPanel（媒体资源面板）**

**职责**：
- 展示OC的所有相关图片和媒体
- 提供图片管理和预览

**设计要点**：
- 瀑布流或网格布局展示所有图片
- 每张图片有标签（如"官方图"、"全身图"、"战斗姿态"等）
- 支持图片预览和全屏查看
- 图片可按类别筛选
- 提供图片上传功能（如果支持编辑）

#### 4.3 页面布局与导航设计

##### **OCDetailPage整体布局**

**Header区域**：
- 面包屑导航：返回列表 > OC名称
- 右侧快速操作：编辑、删除、导出、分享按钮
- 主题颜色可随OC属性变化

**Content区域**：

**选项A：选项卡导航（推荐）**
- 水平选项卡组：基础信息、外观、性格、背景、技能、关系、媒体
- 点击切换对应面板
- 当前选项卡高亮显示
- 支持键盘导航（左右箭头切换）

**选项B：侧边栏导航**
- 左侧固定侧边栏显示所有分类
- 右侧为内容区
- 支持侧边栏收起/展开
- 适合大屏幕展示

**选项C：混合导航**
- 顶部选项卡 + 左侧副导航
- 顶部是主分类，侧边是细分类
- 更灵活但更复杂

##### **OCListPage布局**

**上部控制区**：
- 搜索框（支持模糊搜索OC名字）
- 筛选按钮或筛选面板：
    - 按标签筛选
    - 按创建日期筛选
    - 按性格特质筛选
    - 按能力筛选
- 排序选项：创建日期、修改日期、名字

**中部展示区**：
- OC卡片网格
- 支持响应式布局（自动适应屏幕宽度）
- 分页或无限滚动加载

**右下角**：
- 浮动操作按钮（FAB）：添加新OC

#### 4.4 主题和样式系统

**设计系统要点**：
- 定义颜色变量：主色、辅助色、背景色、文字色等
- 支持Light/Dark两个主题
- 响应式断点：mobile < 640px，tablet 640-1024px，desktop > 1024px
- 间距系统：使用8px为基础单位的间距标准
- 字体系统：定义H1-H6、正文、代码等字体大小和重量
- 圆角标准：sm(4px)、md(8px)、lg(12px)、full(border-radius: 9999px)

**OC专属设计**：
- 每个OC可设置主题色（从头像或手动选择）
- 该主题色应用到卡片、详情页面的强调元素
- 支持属性标签的颜色编码（如火属性=红色、水属性=蓝色）

***

### **五、交互和用户体验设计**

#### 5.1 搜索和筛选功能

**搜索功能**：
- 全局搜索：支持搜索OC名字、昵称、相关标签
- 搜索结果实时显示（debounce 300ms）
- 搜索历史记录（本地存储最近5条搜索）
- 搜索结果支持排序

**筛选功能**：
- 多条件筛选（可同时使用多个筛选器）
- 应用的筛选条件显示为活跃标签，可点击删除
- 筛选结果数量显示
- 支持"清除全部筛选"快捷按钮
- 筛选选项可收起/展开

#### 5.2 编辑和表单设计

**编辑模式**：
- 当前有两种进入编辑的方式：顶部编辑按钮、某些字段的inline编辑
- 编辑前提示存在未保存的更改
- 提供草稿保存功能（自动保存草稿）
- 编辑模式中字段有清晰的验证提示

**表单设计**：
- 长表单分组显示：使用Accordion或选项卡展开相关字段
- 字段标签和帮助文本清晰
- 必填字段使用星号标记
- 类似下拉选择的字段显示预设选项或允许自定义输入
- 支持Undo/Redo（最近10步操作）

#### 5.3 响应式交互

**移动端适配**：
- 卡片宽度自适应
- 触摸友好的按钮大小（最小48px）
- 侧边栏变为侧边抽屉（drawer）
- 详情页面改为滚动视图而非选项卡
- 优化打字体验（虚拟键盘不遮挡重要内容）

**桌面端增强**：
- 支持拖拽操作（如重新排列关系）
- 键盘快捷键（如 Ctrl+E 进入编辑、Ctrl+S 保存）
- 右键菜单快速操作
- 多选操作（批量删除、批量导出）

#### 5.4 数据导入导出

**导出功能**：
- 导出单个OC为JSON文件
- 导出单个OC为PDF名片（格式化的详情报告）
- 导出所有OC为JSON数组或ZIP包
- 支持导出特定面板的信息

**导入功能**：
- 拖拽文件导入OC
- 文件上传对话框
- 导入前验证和预览
- 处理重复的OC名字（提示覆盖或重命名）
- 支持批量导入

***

### **六、数据流和状态管理**

#### 6.1 数据流架构

**数据来源**：
- 本地JSON文件（开发环境）
- LocalStorage（浏览器存储）
- 后端API（可选的扩展）

**数据流向**：
1. 初始化时从存储源加载所有OC数据
2. 用户操作触发状态更新
3. 状态变化自动保存到存储源
4. 相关UI组件订阅状态变化并重新渲染

#### 6.2 状态管理设计

**全局状态需要管理**：
- OC列表数据
- 当前选中的OC
- 编辑状态（是否在编辑）
- 搜索和筛选条件
- 用户偏好设置（主题、语言等）
- 通知/提示消息

**状态管理工具选择**：
- 小型项目：Context API + useReducer
- 中型项目：Zustand（推荐，轻量且易上手）
- 大型项目：Redux + Redux Toolkit

**状态结构例子**（使用Zustand思路）：
- OCStore：管理所有OC相关的状态和操作方法
    - 操作：获取全部OC、获取单个OC、创建OC、更新OC、删除OC等
    - 派生状态：搜索结果、筛选结果等
- UIStore：管理UI相关的状态
    - 当前标签页、侧边栏状态、弹窗状态等
- SettingsStore：管理用户设置
    - 主题、语言、默认排序等

#### 6.3 异步数据处理

**加载状态**：
- 使用loading标志标识数据加载中
- 显示Loading Skeleton或加载进度条
- 加载失败时显示Error State和重试按钮

**数据缓存**：
- 使用缓存避免重复加载
- 实现缓存失效策略（如定期刷新、手动刷新）

**错误处理**：
- 统一的错误处理机制
- 友好的错误提示信息
- 错误日志记录（便于调试）

***

### **七、开发工作流和最佳实践**

#### 7.1 项目初始化

**步骤**：
1. 使用Vite创建React + TypeScript项目模板
2. 安装核心依赖：react、react-dom、typescript
3. 安装状态管理库（如zustand）
4. 安装样式库（如tailwindcss或sass）
5. 配置ESLint和Prettier确保代码质量
6. 设置Git和版本控制

**配置文件**：
- tsconfig.json：TypeScript配置
- vite.config.ts：Vite构建配置
- .eslintrc：代码检查规则
- .prettierrc：代码格式化规则

#### 7.2 开发流程

**第一阶段：类型系统建设**
- 定义所有TypeScript接口和类型
- 创建JSON Schema验证工具
- 编写类型测试用例

**第二阶段：组件开发**
- 从基础UI组件开始（Button、Card、Modal等）
- 开发数据展示组件（各个Panel）
- 集成成页面组件
- 添加交互和状态管理

**第三阶段：功能集成**
- 数据加载和保存
- 搜索、筛选、排序功能
- 编辑和表单处理
- 导入导出功能

**第四阶段：优化和测试**
- 性能优化（代码分割、懒加载等）
- 响应式设计完善
- 单元测试和集成测试
- 可访问性检查（a11y）

#### 7.3 组件开发规范

**命名规范**：
- 文件名使用PascalCase（OCCardComponent.tsx）
- 函数组件名与文件名一致
- Props接口以组件名 + Props结尾（OCCardComponentProps）

**文件组织**：
```
ComponentName/
├── ComponentName.tsx      # 主组件文件
├── ComponentName.module.css  # 样式
├── ComponentName.types.ts # 类型定义
└── index.ts               # 导出
```

**Props设计**：
- 使用接口定义Props类型
- 提供默认Props值
- 使用React.FC<Props>或函数签名定义组件

**样式管理**：
- 使用CSS Modules避免样式冲突
- 或使用Tailwind的className组合
- 避免inline styles（特殊情况除外）

#### 7.4 测试策略

**单元测试**：
- 测试工具：Jest + React Testing Library
- 测试关键业务逻辑（数据转换、验证等）
- 测试组件的用户交互（点击、输入等）

**集成测试**：
- 测试多个组件的协作
- 测试完整的用户流程（搜索、筛选、编辑）

**端到端测试**：
- 使用Cypress或Playwright
- 测试完整的应用场景

***

### **八、性能优化建议**

#### 8.1 加载优化
- 代码分割：使用React.lazy分割大型页面
- 组件懒加载：长列表中未可见的OC卡片延迟渲染
- 图片优化：压缩、使用webp格式、延迟加载

#### 8.2 渲染优化
- 使用useMemo避免不必要的重新计算
- 使用useCallback避免不必要的函数重新创建
- 避免在组件render中创建新对象
- 使用虚拟滚动处理大列表

#### 8.3 存储优化
- 使用IndexedDB处理大量数据
- 实现数据压缩存储
- 定期清理过期数据

***

### **九、扩展性和未来方向**

#### 9.1 可能的扩展功能
- 多用户支持和云同步
- 社交功能：分享OC、评论、点赞
- AI辅助：根据性格生成故事片段
- 关系图可视化编辑
- 配置表情动画和语音

#### 9.2 架构考量
- 模块化设计：可独立更新各个功能
- 插件系统：允许自定义字段和表现形式
- API设计：预留后端集成接口
- 多主题支持：可扩展的主题系统
